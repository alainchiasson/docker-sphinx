# docker-sphinx
A python3 dockerfile/image that has an opionated set of extensions for using [Sphinx](http://sphinx-doc.org/) to generate ReadTheDocs-style documentation. 

## Extensions and Tools

Includes extensions for:

* locally generating the [ReadTheDocs theme](https://github.com/rtfd/sphinx_rtd_theme)
* including embedded plantuml documentation in docstrings
* [pylint](https://github.com/PyCQA/pylint) and with it, pyreverse. pyreverse can generate class diagrams for python modules.
* sphinx latex generation and [pandoc](https://pandoc.org/)
* Mocking mechanism for mocking c callable code (see [documentation](http://read-the-docs.readthedocs.io/en/latest/faq.html#mock-c-extensions))

Please submit pull requests for additional, useful tools and extensions for including in the tool chain.

## How to Use Image

Basic usage is from a docker-enabled system is:

    docker run -it --rm -v <your directory>:/documents/ cloudcompass/docker-rtdsphinx

Running like this starts a bash shell in the docs directory within <your directory>. Use the included bash script rtdgen (see below) as a command line wrapper to run typical sphinx generation commands so you don't have type the full "docker run..." command every time.

The workdir for the image is "docs" within <your directory>, based on the assumption that you are running this from the root of a git repo and that your sphinx setup is in docs/. Within that should be:

* source # the Sphinx documentation
* build # .gitignore'd directory into which the documentation is generated

In the simplest (and expected usage) the generated code is created in <your directory>/docs/build/html, so opening up index.html in that folder opens the root of the documentation.

## Using the rtdgen bash script

This repo includes an bash shell script "rtdgen" that is a wrapper around the docker command (above) to run "typical" document generation steps. It's not necessary, but it's a nice helper.  

**Installation**: Either add this directory to your path, or copy (or link) the file to be in a directory on your path.

Example usage:

```
    rtdgen help  # get usage information on the command
    rtdgen html # clean out and generate html via sphinx
    rtdgen view # Open the root generated html file
    rtdgen clean # clean the generated html
    rtdgen sphinx-quickstart # Run the sphinx quickstart tool
    rtdgen cli # Run the docker container and start a bash shell
```

That last command allows you to do whatever you need in the container from the command line.

The rtdgen script includes some awareness of the platform (windows, mac, linux) and tries to handle those differences.

For information on Sphinx see - More info in the [Sphinx tutorial](http://sphinx-doc.org/tutorial.html).

## Examples

The file "example.conf.py" has the updates necessary to a (fairly generic) conf.py generated by the "sphinx-quickstart" command to use the extensions packaged in this container. Use it directly, or diff it with the generated conf.py to see what needs to be added to your version of the file. 

The built container is available at the [Docker Hub](https://registry.hub.docker.com/u/cloudcompass/docker-rtdsphinx/).