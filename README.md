# docker-sphinx
A python3 dockerfile/image that has an opinionated set of extensions for using [Sphinx](http://sphinx-doc.org/) to generate ReadTheDocs-style documentation. 

## Extensions and Tools

Includes extensions for:

* locally generating the [ReadTheDocs theme](https://github.com/rtfd/sphinx_rtd_theme)
* including embedded plantuml documentation in docstrings
* [pylint](https://github.com/PyCQA/pylint) and with it, pyreverse. pyreverse can generate class diagrams for python modules.
* sphinx latex generation and [pandoc](https://pandoc.org/)
* Mocking mechanism for mocking c callable code (see [documentation](http://read-the-docs.readthedocs.io/en/latest/faq.html#mock-c-extensions))

Please submit pull requests for additional, useful tools and extensions for including in the tool chain.

## How to Use Image: **rtdgen** bash script

The included bash shell script "**rtdgen**" is a wrapper around the docker command (below) to run "typical" document generation steps. It's not necessary, but it's a nice helper to eliminate typing long docker run commands.

**Installation**: Suggest downloading the bin/rtdgen file to a directory on your path.  Alternatively, fork/clone the repo and add the "bin" directory to your path or create a link to the file within a directory already on your path.  So many options. 

**Running**: The script expects you are running the command from the root of your repos - above the docs/ folder where the sphinx code and configuration files can be found.

Example usage:

```
   rtdgen help  # get usage information on the command
    rtdgen html # clean out and generate html via sphinx
    rtdgen view # Open the root generated html file
    rtdgen clean # clean the generated html
    rtdgen sphinx-quickstart # Run the sphinx quickstart tool
    rtdgen cli # Run the docker container and start a bash shell
```

That last command starts a shell in the container, allowing you to do whatever you need in the container from the command line.

The rtdgen script includes some awareness of the platform (windows, mac, linux) and tries to handle those differences.

## How to Use Image - Docker directly

Basic usage is from a docker-enabled system is:

    docker run -it --rm -v <your directory>:/documents/ cloudcompass/docker-rtdsphinx

Running like this starts a bash shell in the docs directory within <your directory>. Use the included bash script rtdgen (see below) as a command line wrapper to run typical sphinx generation commands so you don't have type the full "docker run..." command every time.

## Notes

For getting started with Sphinx see the [Sphinx tutorial](http://sphinx-doc.org/tutorial.html).

The workdir for the image is "docs" within <your directory>, based on the assumption that you are running this from the root of a git repo and that your sphinx setup is in docs/. Within that should be:

* source # the Sphinx documentation
* build # .gitignore'd directory into which the documentation is generated

In the simplest (and expected usage) the generated code is created in <your directory>/docs/build/html, so opening up index.html in that folder opens the root of the documentation.  That is exactly what the "**rtdgen view**" command does.

## Example

The file "example.conf.py" has the updates necessary to a (fairly generic) conf.py generated by the "sphinx-quickstart" command to use the extensions packaged in this container. Use it directly, or diff it with the generated conf.py to see what needs to be added to your version of the file. 

The built container is available at the [Docker Hub](https://registry.hub.docker.com/u/cloudcompass/docker-rtdsphinx/).